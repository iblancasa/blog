<!DOCTYPE html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"><![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head><meta charset="utf-8"><title>Docker &#8211; iblancasa - Blog</title><meta name="description" content="Breve introducción a Docker y los dockerfiles para generar nuestros propios contenedores"><meta name="keywords" content="docker, contenedores, full stack, virtualizacion"><meta name="twitter:title" content="Docker"><meta name="twitter:description" content="Breve introducción a Docker y los dockerfiles para generar nuestros propios contenedores"><meta name="twitter:site" content="@iblancasa"><meta name="twitter:creator" content="@iblancasa"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://blog.iblancasa.com/images/default-thumb.png"><meta property="og:locale" content="es_ES"><meta property="og:type" content="article"><meta property="og:title" content="Docker"><meta property="og:description" content="Breve introducción a Docker y los dockerfiles para generar nuestros propios contenedores"><meta property="og:url" content="http://blog.iblancasa.com/article/tutoriales/docker/"><meta property="og:site_name" content="iblancasa - Blog"><meta property="og:image" content="http://blog.iblancasa.com/images/default-thumb.png"><link rel="canonical" href="http://blog.iblancasa.com/article/tutoriales/docker/"><link href="http://blog.iblancasa.com/feed.xml" type="application/atom+xml" rel="alternate" title="iblancasa - Blog Feed"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="http://blog.iblancasa.com/assets/css/main.css"><meta http-equiv="cleartype" content="on"><!--[if lt IE 9]><script src="http://blog.iblancasa.com/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://blog.iblancasa.com/assets/js/vendor/respond.min.js"></script><![endif]--><script src="http://blog.iblancasa.com/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script><link href="//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic" rel="stylesheet" type="text/css"></head><body class="post"><!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]--><div class="navigation-wrapper"><div class="site-name"><a href="http://blog.iblancasa.com/">iblancasa - Blog</a></div><div class="top-navigation"><nav role="navigation" id="site-nav" class="nav"><ul><li><a href="http://iblancasa.com" target="_blank">Autor</a></li><li><a href="http://blog.iblancasa.com/posts/">Todas las publicaciones</a></li><li><a href="http://blog.iblancasa.com/calendario/">Eventos</a></li></ul></nav></div></div><div id="main" role="main"><div class="article-author-side"><div itemscope itemtype="http://schema.org/Person"><img src="http://blog.iblancasa.com/images/bio-photo.jpg" class="bio-photo" alt="Israel Blancas bio photo"><h3 itemprop="name">Israel Blancas</h3><p>De Granada. Programador. Recién finalizado el Grado de Ingeniería Informática UGR</p><a href="http://twitter.com/iblancasa" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> <a href="http://linkedin.com/in/iblancasa" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> <a href="http://instagram.com/iblancasa93" class="author-social" target="_blank"><i class="fa fa-fw fa-instagram"></i> Instagram</a> <a href="http://github.com/iblancasa" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a> <a href="https://youtube.com/user/iblancasa" class="author-social" target="_blank"><i class="fa fa-fw fa-youtube-square"></i> Youtube</a></div></div><article class="post"><div class="headline-wrap"><h1><a href="http://blog.iblancasa.com/article/tutoriales/docker/" rel="bookmark" title="Docker">Docker</a></h1></div><div class="article-wrap"><p><img src="http://fotos.subefotos.com/4e7301538895cdc19b0eb5f2a3b60730o.png" alt="Docker"></p><h1 id="qu-es-docker">¿Qué es Docker?</h1><p>Docker es una herramienta que permite crear contenedores. Estos contenedores, son sistemas de virtualización que nos permiten tener aplicaciones empaquetadas, de forma que sean autosuficientes (al disponer de todas las bibliotecas y dependencias que estas necesiten).</p><p>En nuestro caso, se ha procedido a crear un contenedor Docker al que <a href="https://registry.hub.docker.com/u/iblancasa/backendsi2-iv/">se puede acceder a través de este enlace.</a></p><h2 id="por-qu-utilizar-docker">¿Por qué utilizar Docker?</h2><ul><li>Es fácil de instalar</li><li><a href="https://docs.docker.com/installation/">Compatible con muchos sistemas operativos y sistemas cloud</a></li><li>Es más seguro que otros métodos (para la máquina anfitriona) ya que los usuarios que acceden a la aplicación solo pueden acceder al entorno creado en el contenedor</li><li>Permite integración continua</li><li>Podemos basarnos en otro contenedor ya creado para ahorranos trabajo</li><li>Gracias a que los contenedores quedan publicados en su web, si alguien quiere hacer una colaboración para mejorar nuestro sistema de virtualización, puede hacerlo</li><li>Estos “tapers” pueden usarse tanto para pruebas como para producción (desde la versión 1 de Docker, ya que las anteriores no eran lo suficientemente maduras)</li><li>Es ligero</li></ul><h2 id="cmo-generar-un-contenedor">¿Cómo generar un contenedor?</h2><h3 id="dockerfile">Dockerfile</h3><p>Para generar este contenedor, se crea un fichero llamado “Dockerfile” y que es el que toma Docker para generar un contenedor. En él, se indican distintas órdenes que permiten al sistema saber qué queremos que se instale (imagen base, ficheros que queremos copiar del repositorio…). <a href="https://docs.docker.com/reference/builder/">Aquí se puede obtener una lista de todas las órdenes disponibles y su sintáxis.</a></p><p>Un ejemplo de Dockerfile:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">FROM ubuntu
MAINTAINER iblancasa &lt;iblancasa <span class="o">[</span>a<span class="o">]</span> gmail.com&gt; Version: 1.0


RUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10
RUN <span class="nb">echo</span> <span class="s1">&#39;deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen&#39;</span> <span class="p">|</span> sudo tee /etc/apt/sources.list.d/mongodb.list
RUN apt-get update
RUN apt-get install -y mongodb-org
RUN service mongod start
RUN apt-get install -y nodejs
RUN apt-get install npm git git-core -y
RUN mkdir /home/app
ADD app /home/app
ADD <span class="nb">test</span> /home/test
COPY package.json /home/
EXPOSE 3000
RUN <span class="nb">cd</span> /home<span class="p">;</span> npm install<span class="p">;</span> npm install -g mocha<span class="p">;</span>npm install mocha chai supertest
CMD <span class="o">[</span><span class="s2">&quot;nohup&quot;</span>,<span class="s2">&quot;/usr/bin/nodejs&quot;</span>, <span class="s2">&quot;app/index.js&quot;</span><span class="o">]</span></code></pre></figure><p>Puedes ejecutarlo en tu máquina con “docker build -t [NAME] .” donde [NAME] es el nombre que desees ponerle.</p><h3 id="generando-el-contenedor-desde-la-web">Generando el contenedor desde la web</h3><p>Para su creación, crea una cuenta en <a href="https://www.docker.com/">Docker.com</a>. Una vez rellenado el formulario y realizadas las pertinentes verificaciones, se accede al panel de administración y se pulsa sobre “Add repository” y se selecciona “Automated Build”).</p><p><img src="http://fotos.subefotos.com/4c89ddc7850be9aa6715e9059b7bf510o.jpg" alt="Add repository"></p><p>Ahora se nos dará opción a elegir entre seleccionar un repositorio que tengamos creado en “GitHub” o “Bitbucket” (será necesario autorizar desde ese servicio que Docker acceda a nuestra lista de repositorios) y después se nos pedirá seleccionar el repositorio con el que queremos vincular).</p><p><img src="http://fotos.subefotos.com/2a75dd7e541191bd415d8965e4f9ceabo.jpg" alt="Seleccionar repositorio"></p><p>Tendremos que esperar un rato a que se Docker se conecte con nuestro repositorio y haga un primer “build”. <strong>Es importante tener un dockerfile válido. En caso contrario, nuestro contenedor no se creará</strong>.</p><p>Cuando tengamos nuestro contenedor creado, podremos ver, en la página inicial de nuestro contenedor en Docker, el contenido del “Readme” de nuestro repositorio. Cuando modifiquemos el repositorio, se hará una nueva construcción de nuestro Docker. En la pestaña “Build Details” accedemos al historial de nuestro Docker, de forma que podemos ver si una construcción ha salido bien o no (y ver qué ha fallado).</p><p><img src="http://fotos.subefotos.com/d90cf3bcf60ddd49e48bd249c1efce40o.jpg" alt="Página inicial del Docker"></p><h2 id="cmo-ejecutar-el-contenedor">¿Cómo ejecutar el contenedor?</h2><p>Para poder usar Docker, tendremos que instalarlo en nuestro ordenador, para ello:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">apt-get update
apt-get install docker.io</code></pre></figure><p>Cuando queramos “arrancar” el servicio, ejecutaremos (como superusuario):</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">docker -d</code></pre></figure><p>Puede que el servicio no arranque y nos avise de un problema con “/var/run/docker.pid”, para ello, borramos el fichero ejecutando “rm /var/run/docker.pid” como superusuario y volvemos a ejecutar la orden anterior.</p><p>En otro terminal, ejecutaremos:</p><p>“docker pull iblancasa/backendsi2-iv”</p><p>Que descargará nuestro Docker. Una vez finalizada la descarga, podremos ejecutar la aplicación ejecutando:</p><figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo docker run -i -t iblancasa/backendsi2-iv /bin/bash -c <span class="s2">&quot;ifconfig;nodejs /home&quot;</span></code></pre></figure><p>Se ejecuta el comando <code>ìfconfig</code> para comprobar la dirección IP y poder acceder, por ejemplo, desde nuestro navegador.</p><p><img src="http://fotos.subefotos.com/8d8c0239e7af219126fe71232ef0db1eo.jpg" alt="Ejecutando Docker"></p><p><img src="http://fotos.subefotos.com/35e57fb13cd35e3020034130454d68f1o.jpg" alt="Aplicación ejecutándose"></p><p>Si solo queremos acceder al terminal (para, por ejemplo, ejecutar los test unitarios):</p><p>“sudo docker run -i -t iblancasa/backendsi2-iv /bin/bash”</p><p>Para facilitar la instalación/ejecución, el repositorio cuenta con un <a href="https://github.com/iblancasa/BackendSI2-IV/blob/master/installDocker.sh">script de Bash</a> que hay que ejecutar como superusuario y que arrancará el docker con la aplicación.</p><hr><footer role="contentinfo"><div class="social-share"><h4>Compartir en...</h4><ul><li><a href="https://twitter.com/intent/tweet?text=http://blog.iblancasa.com/article/tutoriales/docker/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span>Twitter</span></a></li><li><a href="https://www.facebook.com/sharer/sharer.php?u=http://blog.iblancasa.com/article/tutoriales/docker/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span>Facebook</span></a></li><li><a href="https://plus.google.com/share?url=http://blog.iblancasa.com/article/tutoriales/docker/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span>Google+</span></a></li></ul></div><p class="byline"><strong>Docker</strong> publicado en <time datetime="2015-11-20T00:00:00+00:00">November 20, 2015</time>.</p></footer></div></article></div><div class="footer-wrap"><div class="related-articles"><h4>Tambi&eacute;n podría gustarte <small class="pull-right">(<a href="http://blog.iblancasa.com/posts/">Ver todos los posts</a>)</small></h4><ul><li><a href="http://blog.iblancasa.com/article/eventos/hacking-miniblip/" title="Hacking Miniblip">Hacking Miniblip</a></li><li><a href="http://blog.iblancasa.com/article/tutoriales/como-usar-expressjs-con-https/" title="Cómo utilizar ExpressJS con HTTPS">Cómo utilizar ExpressJS con HTTPS</a></li><li><a href="http://blog.iblancasa.com/article/eventos/por-que-me-encantan-los-devfest/" title="¿Por qué me encantan los DevFest?">¿Por qué me encantan los DevFest?</a></li></ul><hr></div><footer><span>&copy; 2015 Israel Blancas. Sobre <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> con <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span></footer></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script>window.jQuery||document.write('<script src="http://blog.iblancasa.com/assets/js/vendor/jquery-1.9.1.min.js"><\/script>');</script><script src="http://blog.iblancasa.com/assets/js/scripts.min.js"></script><script src="/assets/js/plugins/jekyll-search.js"></script></body></html>